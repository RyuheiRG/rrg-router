import{jsx as _jsx}from"react/jsx-runtime";import{Children,useEffect,useState}from"react";import{EVENT}from"../utils/consts";import{match}from"path-to-regexp";import{getCurrentPath}from"../utils/getCurrentPath";export function Router(param){var children=param.children,_param_routes=param.routes,routes=_param_routes===void 0?[]:_param_routes,tmp=param.defaultComponent,DefaultComponent=tmp===void 0?function(){return /*#__PURE__*/_jsx("h1",{children:"404"})}:tmp;var _routesToUse_find;var _useState=useState(getCurrentPath()),currentPath=_useState[0],setCurentPath=_useState[1];useEffect(function(){var onLocationChange=function(){setCurentPath(getCurrentPath())};window.addEventListener(EVENT.PUSHSTATE,onLocationChange);window.addEventListener(EVENT.POPSTATE,onLocationChange);return function(){window.removeEventListener(EVENT.PUSHSTATE,onLocationChange);window.removeEventListener(EVENT.POPSTATE,onLocationChange)}},[]);var routeParams={};var routerFromChildren=Children.map(children,function(param){var props=param.props,type=param.type;var name=type.name;var isRoute=name==="Route";if(!isRoute)return null;return props});var routesToUse=routes.concat(routerFromChildren).filter(Boolean);var Page=(_routesToUse_find=routesToUse.find(function(param){var path=param.path;if(path===currentPath)return true;var matcherUrl=match(path,{decode:decodeURIComponent});var matched=matcherUrl(currentPath);if(!matched)return false;routeParams=matched.params;return true}))==null?void 0:_routesToUse_find.Component;return Page?/*#__PURE__*/_jsx(Page,{routeParams:routeParams}):/*#__PURE__*/_jsx(DefaultComponent,{routeParams:routeParams})}